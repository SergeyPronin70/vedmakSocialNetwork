"use strict";(self.webpackChunkreact_01=self.webpackChunkreact_01||[]).push([[585],{6585:function(e,n,t){t.r(n);var s=t(2982),r=t(885),i=t(2791),u=t(184),l=function(){var e=(0,i.useState)(null),n=(0,r.Z)(e,2),t=n[0],s=n[1];return(0,i.useEffect)((function(){var e,n=function(){console.log("CLOSE WS"),setTimeout(r,3e3)};function r(){var r,i;null===(r=e)||void 0===r||r.removeEventListener("close",n),null===(i=e)||void 0===i||i.close(),e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),null===t||void 0===t||t.addEventListener("close",n),s(e)}return r(),function(){var t,s;null===(t=e)||void 0===t||t.removeEventListener("close",n),null===(s=e)||void 0===s||s.close()}}),[]),(0,u.jsxs)("div",{children:[(0,u.jsx)(o,{wsChannel:t}),(0,u.jsx)(c,{wsChannel:t})]})},o=function(e){var n=e.wsChannel,t=(0,i.useState)([]),l=(0,r.Z)(t,2),o=l[0],c=l[1];return(0,i.useEffect)((function(){var e=function(e){var n=JSON.parse(e.data);c((function(e){return[].concat((0,s.Z)(e),(0,s.Z)(n))}))};return null===n||void 0===n||n.addEventListener("message",e),function(){null===n||void 0===n||n.removeEventListener("message",e),null===n||void 0===n||n.close()}}),[n]),(0,u.jsx)("div",{style:{height:"500px",overflowY:"auto"},children:o.map((function(e,n){return(0,u.jsx)(a,{message:e},n)}))})},a=function(e){var n=e.message;return(0,u.jsxs)("div",{children:[(0,u.jsx)("img",{src:n.photo,style:{width:"30px"}})," ",(0,u.jsx)("b",{children:n.userName}),(0,u.jsx)("br",{}),n.message,(0,u.jsx)("hr",{})]})},c=function(e){var n=e.wsChannel,t=(0,i.useState)(""),s=(0,r.Z)(t,2),l=s[0],o=s[1],a=(0,i.useState)("pending"),c=(0,r.Z)(a,2),d=c[0],v=c[1];(0,i.useEffect)((function(){var e=function(){v("ready")};return null===n||void 0===n||n.addEventListener("open",e),function(){null===n||void 0===n||n.removeEventListener("open",e)}}),[n]);return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{children:(0,u.jsx)("textarea",{onChange:function(e){o(e.currentTarget.value)},value:l})}),(0,u.jsx)("div",{children:(0,u.jsx)("button",{disabled:null===n||"ready"!==d,onClick:function(){l&&(null===n||void 0===n||n.send(l),o(""))},children:"Send"})})]})};n.default=function(){return(0,u.jsx)("div",{children:(0,u.jsx)(l,{})})}}}]);
//# sourceMappingURL=585.14590517.chunk.js.map